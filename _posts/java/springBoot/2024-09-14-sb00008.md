---
layout: single
title: "[ìŠ¤í”„ë§ ë¶€íŠ¸ - ì´í•´ì™€ ì›ë¦¬] @Configurationê³¼ proxyBeanMethods"
categories:
  - springBoot
toc: true
toc_sticky: true
author_profile: true
sidebar:
  nav: "sidebar-category"
---

## @Configurationì˜ ì‘ë™ ì›ë¦¬

@Configurationì´ ë¶™ì€ í´ë˜ìŠ¤ëŠ”Â `CGLIB ë¼ì´ë¸ŒëŸ¬ë¦¬`ë¥¼ ì´ìš©í•´ì„œ í”„ë¡ì‹œ í´ë˜ìŠ¤ë¡œ í™•ì¥ì„ í•´ì„œÂ **@Beanì´ ë¶™ì€ ë©”ì„œë“œì˜ ë™ì‘ë°©ì‹ì„ ë³€ê²½**í•œë‹¤.

> CGLIB(Code Generator Library): ì½”ë“œ ìƒì„± ë¼ì´ë¸ŒëŸ¬ë¦¬ë¡œì„œ ëŸ°íƒ€ì„ì— ë™ì ìœ¼ë¡œ ìë°” í´ë˜ìŠ¤ì˜ í”„ë¡ì‹œë¥¼ ìƒì„±í•´ì£¼ëŠ” ê¸°ëŠ¥ì„ ì œê³µí•œë‹¤. CGLIBëŠ” íƒ€ê²Ÿì— ëŒ€í•œ ì •ë³´ë¥¼ ì§ì ‘ì ìœ¼ë¡œ ì œê³µ ë°›ì•„ ë°”ì´íŠ¸ ì½”ë“œë¥¼ ì¡°ì‘í•˜ì—¬ í”„ë¡ì‹œë¥¼ ìƒì„±í•œë‹¤.

CGLIB ì˜ ë‚´ë¶€ ë™ì‘ ì›ë¦¬ë¥¼ í‘œí˜„í•œ í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì‚´í´ë³´ì

```java
@Test
void proxyCommonMethod() {
    MyConfigProxy myConfigProxy = new MyConfigProxy();

    Bean1 bean1 = myConfigProxy.bean1();
    Bean2 bean2 = myConfigProxy.bean2();

    assertThat(bean1.common).isSameAs(bean2.common);
}

static class MyConfigProxy extends MyConfig {
    private Common common;

    @Override
    Common common() {
        if(this.common == null) this.common = super.common();
        return this.common;
    }
}

@Configuration
static class MyConfig {
    @Bean
    Common common() {
        return new Common();
    }

    @Bean
    Bean1 bean1 () {
        return new Bean1(common());
    }

    @Bean
    Bean2 bean2() {
        return new Bean2(common());
    }
}

static class Bean1 {
    private final Common common;

    Bean1(Common common) {
        this.common = common;
    }
}

static class Bean2 {
    private final Common common;

    Bean2(Common common) {
        this.common = common;
    }
}

static class Common {
}
```

`MyConfigProxy`ê°€ ë°”ë¡œ CGLIBê°€ ê¸°ì¡´ í´ë˜ìŠ¤ë¥¼ í™•ì¥í•˜ì—¬ ìƒì„±í•œ í”„ë¡ì‹œ í´ë˜ìŠ¤ë¥¼ ê°„ëµí•˜ê²Œ ë‚˜íƒ€ë‚¸ ê²ƒì´ë‹¤. í•œ ë²ˆ í˜¸ì¶œëœ Common ì˜¤ë¸Œì íŠ¸ë¥¼ ë³€ìˆ˜ë¡œ ìºì‹±í•˜ì—¬ ê°€ì§€ê³  ìˆë‹¤ê°€ ë‹¤ì‹œ í˜¸ì¶œë˜ë©´ ê¸°ì¡´ì— ìƒì„±ëœ Commonì˜¤ë¸Œì íŠ¸ë¥¼ ë°˜í™˜í•œë‹¤. ì´ ì›ë¦¬ë¡œ ì˜¤ë¸Œì íŠ¸ì˜ ì‹±ê¸€í†¤ì„ ìœ ì§€í•  ìˆ˜ ìˆëŠ” ê²ƒì´ë‹¤. ì—¬ê¸°ê¹Œì§€ê°€ @Configuraitonì˜ ë™ì‘ ì›ë¦¬ë‹¤.

## proxyBeanMethods ì˜µì…˜

ìŠ¤í”„ë§ 5.2ì—ì„œ proxyBeanMethod ì˜µì…˜ì´ ì¶”ê°€ê°€ ë˜ë©´ì„œ ìŠ¤í”„ë§ì— ë“¤ì–´ìˆëŠ” Configuration í´ë˜ìŠ¤ë“¤ì´ proxyBeanMethodì˜µì…˜ì„ falseë¡œ ë°”ê¿”ì„œ ì ìš©í•˜ëŠ” ê²½ìš°ê°€ ë§ì´ ëŠ˜ì–´ë‚¬ë‹¤

ex) SchedulingConfiguration
![image](https://github.com/user-attachments/assets/e5f880b0-c43c-41b6-92bf-33175f04630f)
í•´ë‹¹Â **ì˜µì…˜ì„ falseë¡œ ì£¼ë©´ @Configuration í´ë˜ìŠ¤ì˜ í”„ë¡ì‹œ í´ë˜ìŠ¤ë¥¼ ìƒì„±í•˜ì§€ ì•ŠëŠ”ë‹¤.**

## ğŸ’¡ ì–¸ì œ ì‚¬ìš©í•˜ë©´ ì¢‹ì„ê¹Œ?

ë‚´ê°€ ë§Œì•½ Bean ë©”ì„œë“œë¥¼ í†µí•´ì„œ Bean ì˜¤ë¸Œì íŠ¸ë¥¼ ë§Œë“¤ë•Œ ë˜ ë‹¤ë¥¸ Bean ë©”ì„œë“œë¥¼ í˜¸ì¶œí•´ì„œ ì˜ì¡´ ì˜¤ë¸Œì íŠ¸ë¥¼ ê°€ì ¸ì˜¤ëŠ” ì‹ìœ¼ë¡œ ì½”ë“œë¥¼ ì‘ì„±í•˜ì§€ ì•Šì•˜ë‹¤ë©´ ì‚¬ì‹¤ êµ³ì´ ë§¤ë²ˆ ì‹œê°„ì´ ê±¸ë¦¬ê³  ë¹„ìš©ì´ ë“œëŠ” proxyë¥¼ ë§Œë“œëŠ” ë°©ì‹ìœ¼ë¡œ ì‚¬ìš©í•  í•„ìš”ê°€ ì—†ë‹¤.

ìŠ¤í”„ë§ ê³µì‹ë¬¸ì„œì—ì„œë„ @Bean ì–´ë…¸í…Œì´ì…˜ì´ ë¶™ì€ ë©”ì„œë“œê°€ ë˜ ë‹¤ë¥¸ Beanë©”ì„œë“œë¥¼ í˜¸ì¶œí•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ì‚¬ìš©í•˜ì§€ ì•Šê³  ì´ ìì²´ë¡œ ì´ Beanì„ ìƒì„±í•˜ëŠ”ë° ì¶©ë¶„í•œ ì‘ì—…ì„ ìˆ˜í–‰í•œë‹¤ê³  í•˜ë©´ proxyBeanMethodë¥¼ falseë¡œ ì„¤ì •í•˜ê³  ì‚¬ìš©í•´ë„ ê´œì°®ë‹¤ë¼ê³  ì´ì•¼ê¸°ë¥¼ í•œë‹¤
