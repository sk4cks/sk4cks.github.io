---
layout: single
title: "ğŸ”…[ìŠ¤í”„ë§ ì‹œíë¦¬í‹° OAuth2] OAuth 2.0 Social Login"
categories:
  - springBoot
toc: true
toc_sticky: true
author_profile: true
sidebar:
  nav: "sidebar-category"
---

# 1. íŒŒì¼ êµ¬ì„±

<p align="center"><img src="/assets/images/springBoot/image00000001.png"></p>

1.  ê° OAuth2 ì„œë¹„ìŠ¤ ì œê³µìë“¤ì˜ ì—°ë™ì„ í†µí•´ ì¸ì¦ ë° ì¸ê°€ ê¸°ëŠ¥ì„ êµ¬í˜„í•˜ê³  ê³µí†µí•­ëª©ì€ ì¶”ìƒí™”í•œë‹¤
2.  OpenID Connect Provider ë¥¼ ì§€ì›í•˜ëŠ” ì„œë²„ì™€ ì§€ì›í•˜ì§€ ì•ŠëŠ” ì„œë²„ì— ëŒ€í•˜ì—¬ ìŠ¤í”„ë§ ì‹œíë¦¬í‹°ì˜ ì—°ë™ ì²˜ë¦¬ë¥¼ ìœ„í•œ ë‚´ë¶€ì›ë¦¬ë¥¼ ì´í•´í•œë‹¤
3.  OAuth2UserService ë¥¼ ì»¤ìŠ¤í„°ë§ˆì´ì§•í•˜ì—¬ ì¸ì¦ ì´í›„ íšŒì›ê°€ì… ì²˜ë¦¬ë¥¼ ìœ„í•œ ë¶€ê°€ ì„œë¹„ìŠ¤ë¥¼ êµ¬í˜„í•œë‹¤
4.  OAuth2User ì™€ OidcUser ì²˜ë¦¬ë¥¼ êµ¬ë¶„í•˜ì—¬ êµ¬í˜„í•˜ê³  ìŠ¤í”„ë§ MVC ì—ì„œ íƒ€ì…ë³„ë¡œ ì¸ì¦ê°ì²´ë¥¼ ì°¸ì¡°í•˜ëŠ” ë°©ë²•ì„ ì•Œì•„ë³¸ë‹¤
5.  Scope ì˜ ì •ë³´ë¥¼ ê¶Œí•œì •ë³´ë¡œ ë§¤í•‘í•˜ëŠ” ì›ë¦¬ë¥¼ íŒŒì•…í•˜ê³  ì´ë¥¼ ì»¤ìŠ¤í„°ë§ˆì´ì§•í•˜ëŠ” ë°©ë²•ì„ ì•Œì•„ë³¸ë‹¤

# 2. Google ì—°ë™

## ì—°ë™ ì ˆì°¨

1. OAuth2 Client ì™€ Google ì¸ê°€ì„œë²„ì™€ì˜ ì—°ë™ì„ í†µí•´ ì¸ì¦/ì¸ê°€ í”„ë¡œì„¸ìŠ¤ë¥¼ êµ¬í˜„í•œë‹¤
2. êµ¬ê¸€ ì„œë¹„ìŠ¤ì— ì‹ ê·œ ì„œë¹„ìŠ¤ë¥¼ ìƒì„±í•œë‹¤ - <https://console.cloud.google.com/>
3. application.yml ì„¤ì •

   ```yaml
   spring:
     security:
       oauth2:
         client:
           registration:
             google:
               client-id: 823010453529-xxxxxxxxxxxxxxxxxxxxx
               client-secret: GOCSPX- xxxxxxxxxxxxxxxxxxxxx
   ```

# 3. Naver ì—°ë™

## ì—°ë™ ì ˆì°¨

1. OAuth2 Client ì™€ Naver ì¸ê°€ì„œë²„ì™€ì˜ ì—°ë™ì„ í†µí•´ ì¸ì¦/ì¸ê°€ í”„ë¡œì„¸ìŠ¤ë¥¼ êµ¬í˜„í•œë‹¤
2. ë„¤ì´ë²„ API ì—ì„œ ì‹ ê·œ ì„œë¹„ìŠ¤ë¥¼ ìƒì„±í•œë‹¤ - <https://developers.naver.com/main/>
3. application.yml ì„¤ì •

   ```yaml
   spring:
     security:
       oauth2:
         client:
           provider:
             naver:
               authorization-uri: https://nid.naver.com/oauth2.0/authorize
               jwk-set-uri: https://openapi.naver.com/v1/nid/verify
               token-uri: https://nid.naver.com/oauth2.0/token
               user-info-uri: https://openapi.naver.com/v1/nid/me
               user-name-attribute: response
           registration:
             naver:
               client-id: ad6x8jw3fzuq- xxxxxxxxxxxxxxxxxxxxx
               client-secret: dG4- xxxxxxxxxxxxxxxxxxxxx
               authorization-grant-type: authorization_code
               client-name: naver-client-app
               redirect-uri: http://localhost:8081/login/oauth2/code/naver
               scope: profile,email
   ```

# 4. Keycloak ì—°ë™

## ì—°ë™ ì ˆì°¨

1. OAuth2 Client ì™€ Keycloak ì¸ê°€ì„œë²„ì™€ì˜ ì—°ë™ì„ í†µí•´ ì¸ì¦/ì¸ê°€ í”„ë¡œì„¸ìŠ¤ë¥¼ êµ¬í˜„í•œë‹¤
2. <http://localhost:8080/>
3. application.yml ì„¤ì •

   ```yaml
   spring:
     security:
       oauth2:
         client:
           provider:
             keycloak:
               authorization-uri: http://localhost:8080/realms/oauth2/protocol/openid-connect/auth
               issuer-uri: http://localhost:8080/realms/oauth2
               jwk-set-uri: http://localhost:8080/realms/oauth2/protocol/openid-connect/certs
               token-uri: http://localhost:8080/realms/oauth2/protocol/openid-connect/token
               user-info-uri: http://localhost:8080/realms/oauth2/protocol/openid-connect/userinfo
               user-name-attribute: preferred_username
           registration:
             keycloak:
               authorization-grant-type: authorization_code
               client-id: oauth2-xxxxxxxxxxxxxxxxxxxxx
               client-name: oauth2-client-app
               client-secret: CQueEWXZ-xxxxxxxxxxxxxxxxxxxxx
               redirect-uri: http://localhost:8081/login/oauth2/code/keycloak
               scope: profile,email
   ```

# 5. Form ì¸ì¦ + Kakao ì—°ë™

## ì—°ë™ ì ˆì°¨

1. Form ì¸ì¦ê³¼ OAuth2 ì¸ì¦ì„ ì—°ê³„í•˜ì—¬ ì„œë¹„ìŠ¤í•œë‹¤

   ```java
    http.formLogin().loginPage("/login").loginProcessingUrl("/loginProc").defaultSuccessUrl("/").permitAll();
    http.exceptionHandling().authenticationEntryPoint(new LoginUrlAuthenticationEntryPoint("/login"));
   ```

2. ì¹´ì¹´ì˜¤ API ì—ì„œ ì‹ ê·œ ì„œë¹„ìŠ¤ë¥¼ ìƒì„±í•œë‹¤ - <https://developers.kakao.com/>
3. application.yml ì„¤ì •
   ```yaml
   spring:
     security:
       oauth2:
         client:
           provider:
             kakao:
               issuer-uri: https://kauth.kakao.com
               authorization-uri: https://kauth.kakao.com/oauth/authorize
               token-uri: https://kauth.kakao.com/oauth/token
               user-info-uri: https://kapi.kakao.com/v2/user/me
               user-name-attribute: id
           registration:
             kakao:
               client-id: ad6x8jw3fzuq- xxxxxxxxxxxxxxxxxxxxx
               client-secret: dG4- xxxxxxxxxxxxxxxxxxxxx
               authorization-grant-type: authorization_code
               client-name: kakao-client-app
               redirect-uri: http://localhost:8081/login/oauth2/code/kakao
               scope: openid,profile,email
   ```

# ğŸ“– ì†ŒìŠ¤

<https://github.com/sk4cks/Spring-Security-Oauth2/tree/f539f23dcfeed196cfd60765b2e107c260973977>
