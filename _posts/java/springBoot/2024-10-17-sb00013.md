---
layout: single
title: "ğŸ“ ìŠ¤í”„ë§ JDBC ìë™ êµ¬ì„± ê°œë°œ"
categories:
  - springBoot
toc: true
toc_sticky: true
author_profile: true
sidebar:
  nav: "sidebar-category"
---

## ìë™ êµ¬ì„± í´ë˜ìŠ¤ì™€ ë¹ˆ ì„¤ê³„

ìƒˆë¡œìš´ ê¸°ìˆ ì˜ ìë™ êµ¬ì„± í´ë˜ìŠ¤ë¥¼ ì‘ì„±í•  ë•ŒëŠ” ìë™ êµ¬ì„± í´ë˜ìŠ¤ì— ì ìš©í•  ì¡°ê±´ê³¼ ë§Œë“¤ì–´ì§€ëŠ” ë¹ˆ ì˜¤ë¸Œì íŠ¸ì˜ ì¢…ë¥˜ ë“±ì„ ë¨¼ì € ì„¤ê³„í•œë‹¤.
![image](https://github.com/user-attachments/assets/be3cf52b-b464-4aed-b5ee-ebdf8d38eb8d)
ë‘ ê°œì˜ DataSource êµ¬í˜„ í´ë˜ìŠ¤ë¥¼ ì¡°ê±´ì— ë”°ë¼ ë“±ë¡ë˜ë„ë¡ í•œë‹¤. ì´ ë‘ ê°œì˜ ë¹ˆì€ DataSourcePropertiesë¼ëŠ” í”„ë¡œí¼í‹° í´ë˜ìŠ¤ë¥¼ ì´ìš©í•œë‹¤.

ìŠ¤í”„ë§ JDBC

## DataSource ìë™ êµ¬ì„± í´ë˜ìŠ¤

DataSourceConfigì€ JdbcOperations í´ë˜ìŠ¤ì˜ ì¡´ì¬ë¥¼ í™•ì¸í•´ì„œ ë“±ë¡ë˜ë„ë¡ í•œë‹¤.<br/>
DataSource ë¹ˆ ë©”ì†Œë“œì—ì„œ í”„ë¡œí¼í‹°ë¡œ ì‚¬ìš©í•  í”„ë¡œí¼í‹°ë¥¼ ì •ì˜í•œë‹¤.<br/>
@EnableTransactionManagementëŠ” ì• ë…¸í…Œì´ì…˜ì„ í™œìš©í•œ íŠ¸ëœì­ì…˜ ê¸°ëŠ¥ì„ ê°€ëŠ¥í•˜ê²Œ í•´ì£¼ëŠ” êµ¬ì„±ìš© ì• ë…¸í…Œì´ì…˜ì´ë‹¤.<br/>

```java
@MyAutoConfiguration
@ConditionalMyOnClass("org.springframework.jdbc.core.JdbcOperations")
@EnableMyConfigurationProperties(MyDataSourceProperties.class)
@EnableTransactionManagement
public class DataSourceConfig {
```

SimpleDriverDataSourceëŠ” ê°„ë‹¨í•œ í…ŒìŠ¤íŠ¸ì—ì„œë§Œ ì‚¬ìš©í•´ì•¼ í•œë‹¤. ìš´ì˜ í™˜ê²½ì—ì„œ ì‚¬ìš©í•˜ë©´ ì•ˆ ëœë‹¤.<br/>
@ConditionalOnMissingBeanì„ ì´ìš©í•´ì„œ ì•ì—ì„œ DataSourceê°€ ë“±ë¡ë˜ë©´ ë¹ˆì„ ë§Œë“¤ì§€ ì•Šë„ë¡ í•œë‹¤.

```java
@Bean
@ConditionalOnMissingBean
DataSource dataSource(MyDataSourceProperties properties) throws ClassNotFoundException {
    SimpleDriverDataSource dataSource = new SimpleDriverDataSource();

    dataSource.setDriverClass((Class<? extends Driver>) Class.forName(properties.getDriverClassName()));
    dataSource.setUrl(properties.getUrl());
    dataSource.setUsername(properties.getUsername());
    dataSource.setPassword(properties.getPassword());

    return dataSource;
}
```

<br/>
Hikari Data SourceëŠ” Hikari í´ë˜ìŠ¤ê°€ ì¡´ì¬í•˜ëŠ” ê²½ìš°ì—ë§Œ ë§Œë“¤ì–´ì§€ë„ë¡ ì¡°ê±´ì„ ê±¸ì–´ì¤€ë‹¤.

```java
@Bean
@ConditionalMyOnClass("com.zaxxer.hikari.HikariDataSource")
@ConditionalOnMissingBean
DataSource hikariDataSource(MyDataSourceProperties properties) {
    HikariDataSource dataSource = new HikariDataSource();

    dataSource.setDriverClassName(properties.getDriverClassName());
    dataSource.setJdbcUrl(properties.getUrl());
    dataSource.setUsername(properties.getUsername());
    dataSource.setPassword(properties.getPassword());

    return dataSource;
}
```

## JdbcTemplateê³¼ íŠ¸ëœì­ì…˜ ë§¤ë‹ˆì € êµ¬ì„±

@ConditionalOnSingleCandidateëŠ” ë¹ˆ êµ¬ì„±ì •ë³´ì— í•´ë‹¹ íƒ€ì…ì˜ ë¹ˆì´ í•œ ê°œë§Œ ë“±ë¡ë˜ì–´ìˆëŠ” ê²½ìš°ì— ì¡°ê±´ì´ ë§¤ì¹­ëœë‹¤.

<br/>
JdbcTemplateì€ DataSourceë¥¼ ì£¼ì… ë°›ì•„ì„œ ìƒì„±í•œë‹¤.

```java
@Bean
@ConditionalOnSingleCandidate(DataSource.class)
@ConditionalOnMissingBean
JdbcTemplate jdbcTemplate(DataSource dataSource) {
    return new JdbcTemplate(dataSource);
}

```

ìŠ¤í”„ë§ì˜ íŠ¸ëœì­ì…˜ ì¶”ìƒí™” ê¸°ëŠ¥ì„ í™œìš©í•˜ê¸° ìœ„í•´ì„œ íŠ¸ëœì­ì…˜ ë§¤ë‹ˆì € ë¹ˆë„ ë§Œë“¤ì–´ì¤€ë‹¤.

```java
@Bean
@ConditionalOnSingleCandidate(DataSource.class)
@ConditionalOnMissingBean
JdbcTransactionManager jdbcTransactionManager(DataSource dataSource) {
    return new JdbcTransactionManager(dataSource);
}

```

ì• ë…¸í…Œì´ì…˜ì„ ì´ìš©í•˜ëŠ” íŠ¸ëœì­ì…˜ ê¸°ëŠ¥ì„ ì´ìš©í•˜ê¸° ìœ„í•´ @EnableTransactionManagementì„ í´ë˜ìŠ¤ ë ˆë²¨ì— ë„£ëŠ” ê²ƒë„ ìŠì§€ ë§ì•„ì•¼ í•œë‹¤.

## Hello Repository

> ğŸ’¡ì¸í„°í˜ì´ìŠ¤ì— default ë©”ì†Œë“œ, static ë©”ì†Œë“œë¥¼ ë„£ì–´ì„œ í™œìš©í•˜ëŠ” ë°©ë²•ì€ ìë°”ì˜ Comparator<T> ì¸í„°í˜ì´ìŠ¤ë¥¼ ì°¸ê³ í•˜ë©´ ë„ì›€ì´ ëœë‹¤.

JdbcTemplateì˜ queryForObjectë¥¼ ì´ìš©í•´ì„œ í•˜ë‚˜ì˜ ì¡°íšŒ ê²°ê³¼ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ìˆë‹¤. ì˜¤ë¸Œì íŠ¸ì— ì»¬ëŸ¼ ê°’ì„ ë§¤í•‘í•˜ëŠ” ê²½ìš° RowMapper ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•´ì„œ ResultSetì„ ë°ì´í„° ì˜¤ë¸Œì íŠ¸ë¡œ ì „í™˜í•˜ëŠ” ì½”ë“œë¥¼ ë„£ì–´ ì½œë°±ìœ¼ë¡œ ì „ë‹¬í•´ ì‚¬ìš©í•œë‹¤.

```java
<T> T queryForObject(String sql, RowMapper<T> rowMapper) throws DataAccessException;
```

```java
@FunctionalInterface
public interface RowMapper<T> {

    @Nullable
    T mapRow(ResultSet rs, int rowNum) throws SQLException;
}
```

ë°ì´í„°ë¥¼ ë³€ê²½í•  ë•ŒëŠ” JdbcTemplateì˜ update()ë¥¼ ì´ìš©í•œë‹¤.

## ë¦¬í¬ì§€í† ë¦¬ë¥¼ ì‚¬ìš©í•˜ëŠ” HelloService

í…ŒìŠ¤íŠ¸ ì½”ë“œì— ì‚¬ìš©ë˜ëŠ” ì• ë…¸í…Œì´ì…˜ë„ í•©ì„± ì• ë…¸í…Œì´ì…˜ìœ¼ë¡œ ë§Œë“¤ì–´ ì‚¬ìš©í•˜ë©´ í¸ë¦¬í•˜ë‹¤.

```java
@Retention(RetentionPolicy.RUNTIME)
@Target(ElementType.TYPE)
@ExtendWith(SpringExtension.class)
@ContextConfiguration(classes = HellobootApplication.class)
@TestPropertySource("classpath:/application.properties")
@Transactional
public @interface HellobootTest {

}
```
